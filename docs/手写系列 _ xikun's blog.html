<!DOCTYPE html>
<!-- saved from url=(0090)https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#eventemitter -->
<html lang="en-US" class=" "><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
    <title>手写系列 | xikun's blog</title>
    
    <link rel="icon" href="https://lilixikun.github.io/logo.jpg">
    
    <link rel="preload" href="./手写系列 _ xikun&#39;s blog_files/0.styles.37c174a0.css" as="style"><link rel="preload" href="./手写系列 _ xikun&#39;s blog_files/app.165169bd.js.下载" as="script"><link rel="preload" href="./手写系列 _ xikun&#39;s blog_files/2.5d1923f2.js.下载" as="script"><link rel="preload" href="./手写系列 _ xikun&#39;s blog_files/6.7a42d24e.js.下载" as="script"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/10.430c262a.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/100.f98c75b6.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/101.643aa5c9.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/102.4169a08d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/103.bba53d15.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/104.5f93fab2.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/105.8bf767b2.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/106.5e3057b9.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/107.e4123d3e.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/108.a8658a89.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/109.ed1acd68.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/11.2a5ef8b5.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/110.119dbc01.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/111.61587aa6.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/112.d8e66bc3.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/113.6cd93485.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/114.bb05a19e.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/115.4934bd26.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/116.05065b86.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/117.9ebdef70.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/118.ba22ab2f.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/119.38c0d139.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/12.6b61770c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/120.d043cfc0.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/121.05a7d49c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/122.a728d718.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/123.ca33e6ba.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/124.9960f5fe.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/125.3643ce2d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/126.5a493a3a.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/127.04565ad9.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/128.d1ba087c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/129.84893655.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/13.7d6287c6.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/130.e900a8d0.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/131.d4adcbbf.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/132.85bc621f.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/133.606c1614.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/134.ccc6b062.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/14.4ec434fb.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/15.d77f0136.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/16.49c10d6c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/17.4daae9fc.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/18.05b782ba.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/19.9e738974.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/20.7d9be09b.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/21.4257644f.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/22.8e03a4ab.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/23.41bc235c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/24.fbd09364.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/25.d04924d7.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/26.0858c89a.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/27.f52ac7a1.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/28.641cb987.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/29.7f2894b0.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/3.ed24cb58.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/30.9c877501.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/31.030811c9.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/32.c7d6309d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/33.5bc2a96e.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/34.2fc9354d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/35.0dd295b2.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/36.7f9ccba9.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/37.514759b7.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/38.4d597762.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/39.fdd65167.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/4.3a99199b.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/40.f92130b5.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/41.86e16e03.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/42.f9f6c783.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/43.50b0ea99.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/44.fa007f50.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/45.d54950cf.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/46.f696ee37.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/47.5557c8de.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/48.585e4830.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/49.ab3c7464.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/5.0135b7c8.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/50.bdbd2f8d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/51.1d4802fb.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/52.08e1aafe.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/53.da545b10.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/54.e958884e.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/55.f3278634.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/56.4e3d2cd8.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/57.76d3c565.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/58.307511ae.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/59.a96b8bca.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/60.dbd294b3.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/61.98d8cc1b.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/62.9bda4c2f.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/63.b1f27327.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/64.48b4a6a9.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/65.c35d96de.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/66.f1186bd4.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/67.44e86c4f.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/68.b32b0b49.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/69.c248d05c.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/7.0ee1dc79.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/70.0453a99f.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/71.c7e52d25.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/72.138243bf.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/73.0a6021b4.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/74.aeff0768.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/75.6df76a97.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/76.42db6757.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/77.f3d9ed5c.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/78.d9e35897.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/79.f294ab82.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/8.64d5afed.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/80.daa4f304.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/81.765ea216.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/82.560c9a3c.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/83.f56be7aa.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/84.4bd0a4ee.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/85.1177083d.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/86.deadf4e6.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/87.401900f0.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/88.f1b183c4.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/89.dc8dc687.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/9.2be16a74.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/90.1df1a9f8.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/91.95b75ec2.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/92.e5aa2cb9.js"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/93.b2f94956.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/94.66df6292.js.下载"><link rel="prefetch" href="./手写系列 _ xikun&#39;s blog_files/95.b21e4b8b.js.下载"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/96.cf61c8f7.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/97.a0498192.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/98.89dc82cc.js"><link rel="prefetch" href="https://lilixikun.github.io/assets/js/99.daffc272.js">
    <link rel="stylesheet" href="./手写系列 _ xikun&#39;s blog_files/0.styles.37c174a0.css">
  <style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/6.7a42d24e.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/2.5d1923f2.js.下载"></script><input type="hidden" id="_w_elixir"><script type="text/javascript" src="chrome-extension://dbjbempljhcmhlfpfacalomonjpalpko/scripts/inspector.js"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/21.4257644f.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/48.585e4830.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/49.ab3c7464.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/47.5557c8de.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/7.0ee1dc79.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/93.b2f94956.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/95.b21e4b8b.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/94.66df6292.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/52.08e1aafe.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/70.0453a99f.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/72.138243bf.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/69.c248d05c.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/68.b32b0b49.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/63.b1f27327.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/71.c7e52d25.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/66.f1186bd4.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/67.44e86c4f.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/65.c35d96de.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/64.48b4a6a9.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/79.f294ab82.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/83.f56be7aa.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/80.daa4f304.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/26.0858c89a.js.下载"></script><script charset="utf-8" src="./手写系列 _ xikun&#39;s blog_files/44.fa007f50.js.下载"></script><meta name="description" content="成功的路上一点也不拥挤"></head>
  <body>
    <div id="app"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="https://lilixikun.github.io/" class="home-link router-link-active"><!----> <span class="site-name">xikun's blog</span></a> <div class="links" style="max-width: 1052px;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="" class="" placeholder=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://lilixikun.github.io/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="https://lilixikun.github.io/arithmetic/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="https://lilixikun.github.io/react/" class="nav-link">
  React源码解析
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://lilixikun.github.io/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="https://lilixikun.github.io/arithmetic/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="https://lilixikun.github.io/react/" class="nav-link">
  React源码解析
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items" style=""><li><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html" class="active sidebar-link">手写系列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#new" class="sidebar-link">new</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#call" class="sidebar-link">call</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#apply" class="sidebar-link">apply</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#bind" class="sidebar-link">bind</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#object" class="sidebar-link">object</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#extends" class="sidebar-link">extends</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#sleep" class="sidebar-link">sleep</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#instanceof" class="sidebar-link">instanceOf</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#debounce" class="sidebar-link">debounce</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#throttle" class="sidebar-link">throttle</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#map" class="sidebar-link">map</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#reduce" class="sidebar-link">reduce</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#filter" class="sidebar-link">filter</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#flat" class="sidebar-link">flat</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#jsonstringify" class="sidebar-link">jsonStringify</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#jsonparse" class="sidebar-link">jsonParse</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#event" class="sidebar-link">Event</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#eventemitter" class="active sidebar-link">EventEmitter</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#curry" class="sidebar-link">curry</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#uncurrying" class="sidebar-link">unCurrying</a></li><li class="sidebar-sub-header"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#dateformat" class="sidebar-link">DateFormat</a></li></ul></li><li><a href="https://lilixikun.github.io/blog/js/promise.html" class="sidebar-link">Promise</a></li><li><a href="https://lilixikun.github.io/blog/js/%E8%BF%90%E7%AE%97%E7%AC%A6.html" class="sidebar-link">运算符引起的一道题</a></li><li><a href="https://lilixikun.github.io/blog/js/%E9%A2%84%E7%BC%96%E8%AF%91.html" class="sidebar-link">预编译</a></li><li><a href="https://lilixikun.github.io/blog/js/clone.html" class="sidebar-link">克隆</a></li><li><a href="https://lilixikun.github.io/blog/js/%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B.html" class="sidebar-link">JS执行过程</a></li><li><a href="https://lilixikun.github.io/blog/js/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0.html" class="sidebar-link">箭头函数</a></li><li><a href="https://lilixikun.github.io/blog/js/%E9%97%AD%E5%8C%85.html" class="sidebar-link">闭包</a></li><li><a href="https://lilixikun.github.io/blog/js/%E5%85%83%E7%BC%96%E7%A8%8B.html" class="sidebar-link">什么叫元编程</a></li><li><a href="https://lilixikun.github.io/blog/js/%E5%8E%9F%E5%9E%8B.html" class="sidebar-link">原型-原型链</a></li><li><a href="https://lilixikun.github.io/blog/js/%E8%BF%AD%E4%BB%A3%E5%99%A8.html" class="sidebar-link">迭代器</a></li><li><a href="https://lilixikun.github.io/blog/js/EventLoop.html" class="sidebar-link">EventLoop</a></li><li><a href="https://lilixikun.github.io/blog/js/0.1+0.2.html" class="sidebar-link">0.1+0.2不等于0.3</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Framework</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂谈</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="手写系列"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97" class="header-anchor">#</a> 手写系列</h1> <h2 id="new"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#new" class="header-anchor">#</a> new</h2> <p>使用new来调用函数，或者说发生构造函数调用时，会自动执行下面的操作：</p> <ul><li>创建一个空对象</li> <li>链接到原型</li> <li>绑定this值并执行</li> <li>返回新对象</li></ul> <p>利用 <strong>Object.create</strong> 实现如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
    <span class="token comment">// 执行函数</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> res <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> res <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h2 id="call"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#call" class="header-anchor">#</a> call</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mycall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 声明一个 Symbol 属性，防止 fn 被占用</span>
    <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">"fn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thisArg <span class="token operator">=</span> thisArg <span class="token operator">||</span> window<span class="token punctuation">;</span>
    <span class="token comment">//将调用 fn 添加到 thisArg 对象中</span>
    thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">//执行函数</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span>
    <span class="token comment">//删除属性</span>
    <span class="token keyword">delete</span> thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="apply"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#apply" class="header-anchor">#</a> apply</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myapply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"this no a function"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">"fn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">//执行函数</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> thisArg<span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="bind"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#bind" class="header-anchor">#</a> bind</h2> <p>因为bind转换后的函数可以作为构造函数使用，此时this应该指向构造出的实例，而bind函数绑定的第一个参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mybind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"Bind must be called on a function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//保存原函数</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// 拿到参数，为了传给调用者</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment">//构建一个新函数,保存原函数的原型</span>
        <span class="token function-variable function">nop</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">bound</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// this instanceof nop, 判断是否使用 new 来调用 bound</span>
            <span class="token comment">// 如果是 new 来调用的话，this的指向就是其实例，</span>
            <span class="token comment">// 如果不是 new 调用的话，就改变 this 指向到指定的对象 o</span>
            <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">nop</span> <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token operator">:</span> thisArg<span class="token punctuation">,</span>
                args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 箭头函数没有 prototype，箭头函数this永远指向它所在的作用域</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nop<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prototype
    <span class="token punctuation">}</span>

    <span class="token comment">//修改原型函数的绑定指向</span>
    bound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">nop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> bound<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 测试 myBind</span>
<span class="token keyword">const</span> <span class="token function-variable function">bar1</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

bar1<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'foo'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bound <span class="token operator">=</span> bar1<span class="token punctuation">.</span><span class="token function">mybind</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">bound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bar, [22, 33, 44]</span>
<span class="token function">bound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo, [22, 33, 44]</span>

</code></pre></div><h2 id="object"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#object" class="header-anchor">#</a> object</h2> <p><strong>Object.create</strong>的基本原理：该方法创建一个新对象，并使用现有的对象来提供新创建的对象的__proto__</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 思路：将传入的对象作为原型</span>
<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认情况下newObj.<strong>proto</strong>== F.prototype，在本例中则重写了构造函数F的原型属性，最终的原型关系链为newObj.<strong>proto</strong>== F.prototype == o</p> <h2 id="extends"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#extends" class="header-anchor">#</a> extends</h2> <p>手写一个继承</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 利用 空对象作中介实现继承</span>
<span class="token keyword">var</span> extend <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Target<span class="token punctuation">,</span> Origin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Origin</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
        <span class="token class-name">Target</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Target</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>construct <span class="token operator">=</span> Target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="sleep"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#sleep" class="header-anchor">#</a> sleep</h2> <p>实现一个 sleep 函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start <span class="token operator">&lt;</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'111'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'222'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="instanceof"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#instanceof" class="header-anchor">#</a> instanceOf</h2> <p><strong>instanceof</strong> 运算符用来判断一个构造函数的 <strong>prototype</strong> 属性所指向的对象是否存在另外一个要检测对象的原型链上
语法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">MyInstanceOf</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lef<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> proto <span class="token operator">=</span> lef<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
    <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> prototype<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
        proto <span class="token operator">=</span> proto<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="debounce"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#debounce" class="header-anchor">#</a> debounce</h2> <p>概念： 在事件被触发n秒后再执行回调，如果在这n秒内又被触发，则重新计时。</p> <p>生活中的实例： 如果有人进电梯（触发事件），那电梯将在10秒钟后出发（执行事件监听器），这时如果又有人进电梯了（在10秒内再次触发该事件），我们又得等10秒再出发（重新计时）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">debounce</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait <span class="token operator">=</span> <span class="token number">1000</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 调用非立即执行版本  会先执行一次 再进行函数防抖
 * @param {*} fn 
 * @param {*} wait 
 * @param {*} immediate 
 */</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> immediate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> callNow <span class="token operator">=</span> <span class="token operator">!</span>timer<span class="token punctuation">;</span>
            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>callNow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="throttle"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#throttle" class="header-anchor">#</a> throttle</h2> <p>定义：当持续触发事件时，保证一定时间段内只调用一次事件处理函数，按照一定的规律在某个时间间隔内去处理函数。假如在一个页面中有任意多张图片，那么就有可能会使用懒加载技术，譬如图片的懒加载，我希望在下滑过程中图片不断的被加载出来，而不是只有当我停止下滑时候，图片才被加载出来。那么节流就是在一定时间间隔内触发一次事件。</p> <p><strong>原理：原理是通过判断是否达到一定时间来触发函数，使得一定时间内只触发一次函数。</strong></p> <p>高频事件触发，但在n秒内只会执行一次，所以节流会稀释函数的执行频率</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> prev <span class="token operator">&gt;</span> wait<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
            prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="map"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#map" class="header-anchor">#</a> map</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// map 函数接收一个函数,然后一个新的数组</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> resArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        resArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        index<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> resArr
<span class="token punctuation">}</span>
</code></pre></div><h2 id="reduce"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#reduce" class="header-anchor">#</a> reduce</h2> <p><strong>reducer</strong> 函数接收4个参数:</p> <ul><li>Accumulator (acc) (累计器)</li> <li>Current Value (cur) (当前值)</li> <li>Current Index (idx) (当前索引)</li></ul> <blockquote><p>arr.reduce(callback(accumulator, currentValue, currentIndex, array),initialValue)</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">reduce</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> initValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> sourceArray <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>initValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        initValue <span class="token operator">=</span> sourceArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        index <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> sourceArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        initValue <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>initValue<span class="token punctuation">,</span> sourceArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> sourceArray<span class="token punctuation">)</span>
        index<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> initValue
<span class="token punctuation">}</span>


<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
a<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index<span class="token punctuation">,</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
    <span class="token keyword">return</span> acc <span class="token operator">+</span> cur
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="filter"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#filter" class="header-anchor">#</a> filter</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// filter 接收一个函数 返回符合要求组成的一个新数组</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
</code></pre></div><h2 id="flat"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#flat" class="header-anchor">#</a> flat</h2> <p>JS 实现数组扁平化</p> <p>方法一 递归处理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">flat</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> item <span class="token operator">=</span> ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">flat</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法二 利用 reduce</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flatten</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> pre<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">flatten</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span> <span class="token operator">:</span> cur<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法三 利用扩展运算符</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>ary<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span>isArray<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>ary<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">flatten</span><span class="token punctuation">(</span>ary<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="jsonstringify"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#jsonstringify" class="header-anchor">#</a> jsonStringify</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON</span>
<span class="token comment">// undefined、任意函数以及symbol，会被忽略（出现在非数组对象的属性值中时），或者被转换成 null（出现在数组中时）。</span>
<span class="token comment">// 不可枚举的属性会被忽略</span>
<span class="token comment">// 如果一个对象的属性值通过某种间接的方式指回该对象本身，即循环引用，属性也会被忽略。</span>
<span class="token keyword">function</span> <span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">"object"</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/string|undefined|function/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            obj <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token operator">+</span> obj <span class="token operator">+</span> <span class="token string">'"'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> json <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        arr <span class="token operator">=</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> v <span class="token operator">=</span> obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> v<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/string|undefined|function/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                v <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token operator">+</span> v <span class="token operator">+</span> <span class="token string">'"'</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                v <span class="token operator">=</span> <span class="token function">jsonStringify</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            json<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">'"'</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">'":'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">"["</span> <span class="token operator">:</span> <span class="token string">"{"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">"]"</span> <span class="token operator">:</span> <span class="token string">"}"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// "{"x":5}"</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"false"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// "[1,"false",false]"</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="jsonparse"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#jsonparse" class="header-anchor">#</a> jsonParse</h2> <p>利用 <strong>eval</strong> 实现</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">jsonParse</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'('</span> <span class="token operator">+</span> str <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Function</strong> 版本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> jsonStr <span class="token operator">=</span> <span class="token string">'{ "age": 20, "name": "jack" }'</span>
<span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'return '</span> <span class="token operator">+</span> jsonStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="event"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#event" class="header-anchor">#</a> Event</h2> <p>实现一个组件通信,一个监听和触发的过程</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 监听事件</span>
    <span class="token function">addListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//触发事件</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
        <span class="token function">handle</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 监听事件</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">"ages"</span><span class="token punctuation">,</span> <span class="token parameter">age</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 触发事件</span>
emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'ages'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="eventemitter"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#eventemitter" class="header-anchor">#</a> EventEmitter</h2> <p>实现发布订阅</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 支持一个名字订阅多个事件函数</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 触发事件</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 移除某个名字下订阅的函数</span>
    <span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> cb <span class="token operator">!=</span> fn<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 只执行一次订阅的事件，然后移除</span>
    <span class="token function">once</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 绑定的是fn, 执行的时候会触发fn函数</span>
        <span class="token keyword">let</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fn函数中调用原有的callback</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除fn, 再次执行的时候之后执行一次</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> em <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> workday <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
em<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    workday<span class="token operator">++</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"work everyday"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

em<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">"love"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"just love you"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">makeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"make one million money"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
em<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">,</span> makeMoney<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    em<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    em<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">,</span> makeMoney<span class="token punctuation">)</span><span class="token punctuation">;</span>
    em<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    em<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">"love"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>workday <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"have a rest"</span><span class="token punctuation">)</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="curry"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#curry" class="header-anchor">#</a> curry</h2> <p>手写实现函数柯里化</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> length <span class="token operator">=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> args <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newArgs<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">curry</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> newArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">multiFn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b <span class="token operator">*</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> multi <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>multiFn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ES6 写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">curry</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token punctuation">(</span><span class="token parameter">arg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>length <span class="token operator">===</span> fn<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">curry</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token operator">...</span>arr<span class="token punctuation">,</span>
        <span class="token operator">...</span>args
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> curryTest <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">curryTest</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回10</span>
<span class="token function">curryTest</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回10</span>
<span class="token function">curryTest</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回10</span>
</code></pre></div><h2 id="uncurrying"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#uncurrying" class="header-anchor">#</a> unCurrying</h2> <p>反柯里化，从字面讲，意义和用法跟函数柯里化相比正好相反，扩大适用范围，创建一个应用范围更广的函数。使本来只有特定对象才适用的方法，扩展到更多的对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通用版</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">unCurrying</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> rest<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="dateformat"><a href="https://lilixikun.github.io/blog/js/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97.html#dateformat" class="header-anchor">#</a> DateFormat</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Date</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">format</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fmt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">"M+"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>                 <span class="token comment">//月份 </span>
        <span class="token string">"d+"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token comment">//日 </span>
        <span class="token string">"h+"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">//小时 </span>
        <span class="token string">"m+"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                 <span class="token comment">//分 </span>
        <span class="token string">"s+"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                 <span class="token comment">//秒 </span>
        <span class="token string">"q+"</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//季度 </span>
        <span class="token string">"S"</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment">//毫秒 </span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/(y+)/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">"("</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            fmt <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"00"</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd hh:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>所有手写代码请移步 <a href="https://github.com/LiLixikun/Blog-example/tree/master/packages/js" target="_blank" rel="noopener noreferrer">JS手写代码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">12/9/2020, 9:34:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="https://lilixikun.github.io/blog/js/promise.html" class="">
        Promise
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><svg data-v-5fd4ef0c="" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49.484 28.284" class="go-to-top"><g data-v-5fd4ef0c="" transform="translate(-229 -126.358)"><rect data-v-5fd4ef0c="" fill="currentColor" width="35" height="5" rx="2" transform="translate(229 151.107) rotate(-45)"></rect> <rect data-v-5fd4ef0c="" fill="currentColor" width="35" height="5" rx="2" transform="translate(274.949 154.642) rotate(-135)"></rect></g></svg></div></div>
    <script src="./手写系列 _ xikun&#39;s blog_files/app.165169bd.js.下载" defer=""></script><script src="./手写系列 _ xikun&#39;s blog_files/2.5d1923f2.js.下载" defer=""></script><script src="./手写系列 _ xikun&#39;s blog_files/6.7a42d24e.js.下载" defer=""></script>
  

</body></html>