# 作用域

该篇主要讲述 javascript 的词法作用域以及作用域链

## 作用域

作用域是指程序源代码中定义变量的区域。

作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限。

JavaScript 采用词法作用域(lexical scoping)，也就是静态作用域。

## 词法作用域

在你不知道的 javascript 中这样定义：词法作用域是定义在词法阶段的作用域。就是由你在写代码时将变量和块作用域写在哪里决定的，当词法分析器处理代码时或保持作用域不变。

在 JS 中词法作用域的规则：

-   函数允许访问函数外部的数据
-   整个代码结构中只有函数可以限定作用域
-   作用规则首先使用提升规则分析
-   如果当前作用域中有了名字了，就不考虑外面的名字

这个类似于预编译。

## 作用域链

在 javascript 中，作用域一般分为 全局作用域和函数作用域。
凡是代码中有函数，那么这个函数就构成另一个作用域。如果函数中还有函数，那么在这个作用域中就又可以诞生一个作用域，那么将这样的所有作用域列出来，可以有一个结构：函数内指向函数外的链式结构。

```js
function foo() {
	console.log(a); // 2
}
function bar() {
	var a = 3;
	foo();
}
var a = 2;
bar();
```

-   全局作用域：bar、a 、foo
-   bar 函数创建的作用域，有一个标识符 a

![EventLoop](/js/词法作用域/词法作用域.png)

所以无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由函数被声明时所处的位置决定(this 除外)。
